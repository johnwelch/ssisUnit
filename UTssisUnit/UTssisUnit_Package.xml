<?xml version="1.0" encoding="utf-8" ?>
<TestSuite xmlns="http://tempuri.org/ssisUnit.xsd">
  <ConnectionList>
    <Connection name="AdventureWorks" connectionType="ConnectionString" connection="Provider=SQLOLEDB;Data Source=localhost;Integrated Security=SSPI;Initial Catalog=Adventureworks"/>
  </ConnectionList>
  <Setup>
    <SQLCommand connectionRef="AdventureWorks" returnsValue="false">
      CREATE TABLE [dbo].[TestTable](
      [ID] [int] IDENTITY(1,1) NOT NULL PRIMARY KEY,
      [ColName] [varchar](50) NOT NULL)
    </SQLCommand>
  </Setup>
  <Tests>
    <Test name="Test Get Starting Row Count" package="C:\Projects\SSISUnit\SSIS2005\SSIS2005\UT_Simple.dtsx" task="Get Starting Row Count" expectedResult="0">
      <VariableCommand name="RowCount"/>
    </Test>
    <Test name="Test Get Ending Row Count" package="C:\Projects\SSISUnit\SSIS2005\SSIS2005\UT_Simple.dtsx" task="Get Ending Row Count" expectedResult="504">
      <VariableCommand name="RowCount"/>
    </Test>
  </Tests>
  <Teardown>
    <SQLCommand connectionRef="AdventureWorks" returnsValue="false">
      DROP TABLE dbo.TestTable
    </SQLCommand>
  </Teardown>
</TestSuite>
